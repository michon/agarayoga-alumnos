<!DOCTYPE html>
<html>
  <head>
    <title>AgarayogaAlumnos</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <meta charset="utf-8">
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/fontawesome.min.css" integrity="sha384-jLKHWM3JRmfMU0A5x5AkjWkw/EYfGUAGagvnfryNV3F9VqM98XiIH7VBGVoxVSc7" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css" integrity="sha384-ejwKkLla8gPP8t2u0eQyL0Q/4ItcnyveF505U0NIobD/SMsNyXrLti6CWaD0L52l" crossorigin="anonymous">
    <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_pack_tag 'application', 'data-turbolinks-track': 'reload' %>
  </head>

  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a href="#" class="navbar-brand">AgâraYoga</a>
            <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-between" id="navbarCollapse">
                <ul class="navbar-nav navbar-dark">
                  <%= link_to 'Michon', indice_path, class: "nav-item nav-link active" %>

                  <li class="nav-item dropdown" id="desplegableClases">
                    <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">Clases</a>
                    <ul class="dropdown-menu">
                      <li> <%= link_to "Clases de hoy",         clase_dia_path(:fecha => DateTime.now),    method: :post, class: "dropdown-item" %></li>
                      <li> <%= link_to "Clases de esta semana", clase_semana_path(:fecha => Date.today), method: :post, class: "dropdown-item" %></li>
                    </ul>
                  </li>

                  <li class="nav-item dropdown" id="desplegableAlumnos">
                    <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown"> Alumnos </a>
                    <ul class="submenu dropdown-menu">
                      <li><%= link_to 'Listado alumnos', alumnos_index_path, class: "dropdown-item"  %></li>
                      <li> <%= link_to "Últimas incorporaciones", alumnos_business_get_path(:fecha => DateTime.now), method: :post, class: "dropdown-item"  %></li>
                      <li> <%= link_to "Procesos", alumnos_procesos_path(), method: :post, class: "dropdown-item"  %></li>
                    </ul>
                  </li>

                  <li class="nav-item dropdown" id="desplegableHorarios">
                    <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown"> Horario </a>
                    <ul class="submenu dropdown-menu">
                      <li><%= link_to 'General',      horario_index_path, class: "dropdown-item" %></li>
                      <li><%= link_to 'Horas Libres', horario_libre_path, class: "dropdown-item" %></li>
                    </ul>
                  </li>

                  <li class="nav-item dropdown" id="desplegableInstructores">
                    <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown"> Instructores </a>
                    <ul class="submenu dropdown-menu">
                      <li><%= link_to 'Raquel mes actual',     instructor_path(:id => 2, :fecha => DateTime.now()), class: "dropdown-item" %></li>
                      <li><%= link_to 'Raquel mes anterior',   instructor_path(:id => 2, :fecha => DateTime.now()-1.month), class: "dropdown-item" %></li>
                    </ul>
                  </li>
                </ul>


                <ul class="navbar-nav navbar-dark">
                    <% if current_usuario %>
                        <li class="dropdown" id="desplegableUsuarios">
                          <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown"> <%=" #{current_usuario.nombre} (#{current_usuario.rol})"  %> </a>
                          <ul class="dropdown-menu dropdown-menu-end">
                              <%= link_to 'Abandonar sesión', destroy_usuario_session_path, data: { turbo: false }, class: "dropdown-item" %>
                          </ul>
                        </li>
                    <%else%>
                          <li class="nav-item nav-menu-end">
                              <%= link_to 'Autenticarse', new_usuario_session_path,       class: "nav-link" %>
                          </li>
                          <li class="nav-item nav-menu-end">
                              <%= link_to 'Darse de alta', new_usuario_registration_path, class: "nav-link" %>
                          </li>
                    <%end%>
                </ul>

            </div>
        </div>
    </nav>

    <div class="container-fluid py-4 my-5">
      <%= render 'layouts/alerts' %>
    </div>

    <div class="container-fluid py-4 my-5">
        <%= yield %>
    </div>

    <footer>
        <div class="row">
            <div class="col-md-6">
                <p>Copyright &copy; 2021 Tutorial Republic</p>
            </div>
            <div class="col-md-6 text-md-end">
                <a href="#" class="text-dark">Terms of Use</a>
                <span class="text-muted mx-2">|</span>
                <a href="#" class="text-dark">Privacy Policy</a>
            </div>
        </div>
    </footer>

    <% unless flash.empty? %>
       <script type="text/javascript">
          <% flash.each do |f| %>
        <% type = f[0].to_s.gsub('alert', 'error').gsub('notice', 'info') %>
         toastr['<%= type %>']('<%= f[1] %>');
       <% end %>
       </script>
    <% end %>

  </body>

</html>
